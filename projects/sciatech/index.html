<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>AI connected medical insoles | Abir Arsalane</title>
<meta name="keywords" content="AI, IOT, AWS, AWS, EY, Innovation, Python, Challenge, ML, DL, Recommendations System, models">
<meta name="description" content="I solved a problem that 600&#43; MILLION people suffer from using AI">
<meta name="author" content="">
<link rel="canonical" href="https://abirarsalane.github.io/projects/sciatech/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.a72801f0f40a8d7f71aa1cafd1c2f2a993a1f26ca1cfd38fdba65d5b9b0f08a0.css" integrity="sha256-pygB8PQKjX9xqhyv0cLyqZOh8myhz9OP26ZdW5sPCKA=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js" integrity="sha256-uVus3DnjejMqn4g7Hni&#43;Srwf3KK8HyZB9V4809q9TWE="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://abirarsalane.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://abirarsalane.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://abirarsalane.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://abirarsalane.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://abirarsalane.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="AI connected medical insoles" />
<meta property="og:description" content="I solved a problem that 600&#43; MILLION people suffer from using AI" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://abirarsalane.github.io/projects/sciatech/" />
<meta property="og:image" content="https://abirarsalane.github.io/projects/SciaTech/SciaTech-logo.jpg" /><meta property="article:section" content="projects" />



<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://abirarsalane.github.io/projects/SciaTech/SciaTech-logo.jpg" />
<meta name="twitter:title" content="AI connected medical insoles"/>
<meta name="twitter:description" content="I solved a problem that 600&#43; MILLION people suffer from using AI"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Projects",
      "item": "https://abirarsalane.github.io/projects/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "AI connected medical insoles",
      "item": "https://abirarsalane.github.io/projects/sciatech/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "AI connected medical insoles",
  "name": "AI connected medical insoles",
  "description": "I solved a problem that 600+ MILLION people suffer from using AI",
  "keywords": [
    "AI", "IOT", "AWS", "AWS", "EY", "Innovation", "Python", "Challenge", "ML", "DL", "Recommendations System", "models"
  ],
  "articleBody": "Introduction The project Scia-Tech is a project combining the power of two powerful technologies: AI and IOT. Scia-Tech’s smart insoles are designed to enhance the user’s daily life. These smart insoles not only track your physical activities, but also offer a unique solution for individuals suffering from sciatica. By closely monitoring their walking patterns, sitting habits, heavy lifting, intense workouts, posture, and any movement. Scia-Tech aims to identify behaviors that may trigger sciatica pain, allowing you to take proactive steps to manage and mitigate discomfort.\nDeeper dive Scia-Tech offers:\nSensor Technology: It provides cutting-edge sensor technology to revolutionize pain management and improve health. Data Analysis and Machine Learning: Collected data from the sensors is processed and the models predict the movement patterns and postures, then this output is fed to other models to forecast potential pain triggers before they strike. The recommendation system then provides personalized insights, guiding the user towards a life free from discomfort. Personal Space: All of this information and more is sent to the user’s account on the mobile application. The user can find reports, get notifications, report pain manually, manage their profile, see the timer predicting when sciatica pain may occur. Technical Aspect The ESP32, equipped with our sensors, sends real-time data to AWS IoT Core using MQTT protocol.\nThis raw data undergoes transformation using ML and DL models to predict position,posture and expected sciatica pain onset.\nWith personal data from the mobile app (from the user’s account including age, gender, weight, height..), real-time pain reports (from the user reporting they’re currently experiencing sciatica pain), and continuous IoT data streaming (used to predict the posture, position, movement and any excessive weight lifted), we create personalized AI-generated recommendations crafted specifically to you.\nLet’s break it down - Scia-Tech’s system, powered by cloud-based microservices, efficiently manages batch oriented workflows and streaming data to process it and generate the adequate outputs.\nPersonalized recommendations mean the system learns from the user’s unique data, not only giving you tailored guidance but also improving our general AI recommendation system.\n1. Input Data From the mobile application: When creating their account, the user enters the following information that we take into consideration when training the models. These inputs are: Age, Gender, Weight, Height.\nFrom the sensors: The insoles are equipped with different sensors including: ESP32 microcontroller,FSR01 load cell and MPU6050 Sensor,\nMPU: Sx, Sy, Sz, Qx, Qy, Qz, Ww, FPS (for each feet) Pressure: P0, P1, P2, P3, P4 (for each feet) 2. How it works Data Generation and Research Having worked on an innovative project, finding data to train the models was pretty challenging. I couln’t find any data for movement, activity or posture prediction from sensors installed in insoles. I couldn’t even find data collected the sensors we had combined. The unique combination of sensors in insoles to predict pain made finding the data a real obstacle, especially free and open source data. Collecting data from hospitals wasn;t an option either because it’s confidential. The solution was generating my own dataset and that’s exactly was I did. I generated a dataset of douzains of people using the insoles in different positions and postures, doing various activities such as walking, sitting, running, jumping, lifting heavy weights,… I worked alongside a doctor, I got all the information necessary and, throught weekly meetings, kept iterating my models, feature engineering and experimenting to increase the performance. The results can never be perfect because in the medical field it’s very hard to predict the future because nature cannot be predicted, people are all different and unique and no case is like the other. The goal was not to get perfect results but to increase the probablities accuracy based on all the elements we could have. More data could’ve been beneficial but the goal was to implement the project using insoles and insoles only because that was our innovative approach. This project required a lot of research, from domain research about sciatica, medical conditions, exceptions, and parameters, to technical research when deciding on the right models, the right features, reading similar research papers and more.\nThe pipeline The ESP32, equipped with our sensors, sends real-time data to AWS IoT Core using MQTT protocol. This raw data undergoes transformation first using AWS Lambda functions for pre-processing tasks, distribution of inputs into different databases such as AWS S3 and AWS DynamoDB, and posture and movement prediction using an ML pre-trained model stored in a Lambda function. The processed data is then ingested as an input of the sciatica pain predictive model using AWS SageMaker. The outputs are then sent to our mobile application for display.\n3. Output Data The output of this project is:\nPain Prediction: The app features AI technology integrated with smart insole data to display a timer predicting when sciatica pain may occur. You can also manually log pain incidents, specifying whether they occurred during sitting, standing, or heavy activity. Reports: Access daily, weekly, and historical reports of your activities and pain incidents. Notifications: Receive reminders and notifications to help you manage your daily routines and avoid pain triggers. Profile Management: Update and modify your profile information as needed. ",
  "wordCount" : "854",
  "inLanguage": "en",
  "image":"https://abirarsalane.github.io/projects/SciaTech/SciaTech-logo.jpg","datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "0001-01-01T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://abirarsalane.github.io/projects/sciatech/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Abir Arsalane",
    "logo": {
      "@type": "ImageObject",
      "url": "https://abirarsalane.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header sticky-header">
    <nav class="nav">
        <div class="logo">
            <a href="https://abirarsalane.github.io/" accesskey="h" title="Abir Arsalane (Alt + H)">Abir Arsalane</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://abirarsalane.github.io/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://abirarsalane.github.io/blog" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://abirarsalane.github.io/projects" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
            <li>
                <a href="https://abirarsalane.github.io/experience" title="Experience">
                    <span>Experience</span>
                </a>
            </li>
            <li>
                <a href="https://abirarsalane.github.io/achievements" title="Achievements">
                    <span>Achievements</span>
                </a>
            </li>
            <li>
                <a href="https://abirarsalane.github.io/search" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://abirarsalane.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://abirarsalane.github.io/projects/">Projects</a></div>
    <h1 class="post-title">
      AI connected medical insoles
    </h1>
    <div class="post-description">
      I solved a problem that 600&#43; MILLION people suffer from using AI
    </div>
    <div class="post-meta">


Oct 2023

</div>
  </header> 
<figure class="entry-cover"><img loading="lazy" src="https://abirarsalane.github.io/projects/SciaTech/SciaTech-logo.jpg" alt="">
        
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">‎ Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#introduction" aria-label="Introduction">Introduction</a></li>
                <li>
                    <a href="#deeper-dive" aria-label="Deeper dive">Deeper dive</a></li>
                <li>
                    <a href="#technical-aspect" aria-label="Technical Aspect">Technical Aspect</a><ul>
                        
                <li>
                    <a href="#1-input-data" aria-label="1. Input Data">1. Input Data</a></li>
                <li>
                    <a href="#2-how-it-works" aria-label="2. How it works">2. How it works</a><ul>
                        
                <li>
                    <a href="#data-generation-and-research" aria-label="Data Generation and Research">Data Generation and Research</a></li>
                <li>
                    <a href="#the-pipeline" aria-label="The pipeline">The pipeline</a></li></ul>
                </li>
                <li>
                    <a href="#3-output-data" aria-label="3. Output Data">3. Output Data</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h1>
<p>The project  Scia-Tech is a project combining the power of two powerful technologies: AI and IOT. Scia-Tech&rsquo;s smart insoles are designed to enhance the user&rsquo;s daily life. These smart insoles not only track your physical activities, but also offer a unique solution for individuals suffering from sciatica. By closely monitoring their walking patterns, sitting habits, heavy lifting, intense workouts, posture, and any movement. Scia-Tech aims to identify behaviors that may trigger sciatica pain, allowing you to take proactive steps to manage and mitigate discomfort.</p>
<p><img loading="lazy" src="/projects/SciaTech/SciaTech%20DEMO.mp4" alt=""  />

<video width="700" height="300" controls></p>
  <source src="/projects/SciaTech/SciaTech DEMO.mp4" type="video/mp4">
</video>
<h1 id="deeper-dive">Deeper dive<a hidden class="anchor" aria-hidden="true" href="#deeper-dive">#</a></h1>
<p>Scia-Tech offers:</p>
<ul>
<li><strong>Sensor Technology:</strong> It provides cutting-edge sensor technology to revolutionize pain management and improve health.</li>
<li><strong>Data Analysis and Machine Learning:</strong> Collected data from the sensors is processed and the models predict the movement patterns and postures, then this output is fed to other models to forecast potential pain triggers before they strike. The recommendation system then provides personalized insights, guiding the user towards a life free from discomfort.</li>
<li><strong>Personal Space:</strong> All of this information and more is sent to the user&rsquo;s account on the mobile application. The user can find reports, get notifications, report pain manually, manage their profile, see the timer predicting when sciatica pain may occur.</li>
</ul>
<h1 id="technical-aspect">Technical Aspect<a hidden class="anchor" aria-hidden="true" href="#technical-aspect">#</a></h1>
<p>The ESP32, equipped with our sensors, sends real-time data to AWS IoT Core using MQTT protocol.</p>
<p>This raw data undergoes transformation using ML and DL models to predict position,posture and expected sciatica pain onset.</p>
<p>With personal data from the mobile app (from the user’s account including age, gender, weight, height..), real-time pain reports (from the user reporting they’re currently experiencing sciatica pain), and continuous IoT data streaming (used to predict the posture, position, movement and any excessive weight lifted), we create personalized AI-generated recommendations crafted specifically to you.</p>
<p>Let&rsquo;s break it down - Scia-Tech&rsquo;s system, powered by cloud-based microservices, efficiently manages batch oriented workflows and streaming data to process it and generate the adequate outputs.</p>
<p>Personalized recommendations mean the system learns from the user&rsquo;s unique data, not only giving you tailored guidance but also improving our general AI recommendation system.</p>
<h2 id="1-input-data">1. Input Data<a hidden class="anchor" aria-hidden="true" href="#1-input-data">#</a></h2>
<p><strong>From the mobile application:</strong>
When creating their account, the user enters the following information that we take into consideration when training the models.
These inputs are: Age, Gender, Weight, Height.</p>
<p><img loading="lazy" src="/projects/SciaTech/userflow.png" alt=""  />
</p>
<p><strong>From the sensors:</strong>
The insoles are equipped with different sensors including: ESP32 microcontroller,FSR01 load cell and MPU6050 Sensor,</p>
<ul>
<li>MPU: Sx, Sy, Sz, Qx, Qy, Qz, Ww, FPS (for each feet)</li>
<li>Pressure: P0, P1, P2, P3, P4 (for each feet)</li>
</ul>
<p><img loading="lazy" src="/projects/SciaTech/MPU.png" alt=""  />

<img loading="lazy" src="/projects/SciaTech/Pressure.jpg" alt=""  />
</p>
<h2 id="2-how-it-works">2. How it works<a hidden class="anchor" aria-hidden="true" href="#2-how-it-works">#</a></h2>
<h3 id="data-generation-and-research">Data Generation and Research<a hidden class="anchor" aria-hidden="true" href="#data-generation-and-research">#</a></h3>
<p>Having worked on an innovative project, finding data to train the models was pretty challenging. I couln&rsquo;t find any data for movement, activity or posture prediction from sensors installed in insoles. I couldn&rsquo;t even find data collected the sensors we had combined. The unique combination of sensors in insoles to predict pain made finding the data a real obstacle, especially free and open source data. Collecting data from hospitals wasn;t an option either because it&rsquo;s confidential. The solution was <strong>generating my own dataset</strong> and that&rsquo;s exactly was I did. I generated a dataset of douzains of people using the insoles in different positions and postures, doing various activities such as walking, sitting, running, jumping, lifting heavy weights,&hellip;
I worked alongside a doctor, I got all the information necessary and, throught weekly meetings, kept iterating my models, feature engineering and experimenting to increase the performance. The results can never be perfect because in the medical field it&rsquo;s very hard to predict the future because nature cannot be predicted, people are all different and unique and no case is like the other. The goal was not to get perfect results but to increase the probablities accuracy based on all the elements we could have. More data could&rsquo;ve been beneficial but the goal was to implement the project using insoles and insoles only because that was our innovative approach.
This project required a lot of research, from domain research about sciatica, medical conditions, exceptions, and parameters, to technical research when deciding on the right models, the right features, reading similar research papers and more.</p>
<h3 id="the-pipeline">The pipeline<a hidden class="anchor" aria-hidden="true" href="#the-pipeline">#</a></h3>
<p>The ESP32, equipped with our sensors, sends real-time data to AWS IoT Core using MQTT protocol. This raw data undergoes transformation first using AWS Lambda functions for pre-processing tasks, distribution of inputs into different databases such as AWS S3 and AWS DynamoDB, and posture and movement prediction using an ML pre-trained model stored in a Lambda function. The processed data is then ingested as an input of the sciatica pain predictive model using AWS SageMaker. The outputs are then sent to our mobile application for display.</p>
<p><img loading="lazy" src="/projects/SciaTech/pipeline.png" alt=""  />
</p>
<h2 id="3-output-data">3. Output Data<a hidden class="anchor" aria-hidden="true" href="#3-output-data">#</a></h2>
<p>The output of this project is:</p>
<ul>
<li>Pain Prediction: The app features AI technology integrated with smart insole data to display a timer predicting when sciatica pain may occur. You can also manually log pain incidents, specifying whether they occurred during sitting, standing, or heavy activity.</li>
<li>Reports: Access daily, weekly, and historical reports of your activities and pain incidents.</li>
<li>Notifications: Receive reminders and notifications to help you manage your daily routines and avoid pain triggers.</li>
<li>Profile Management: Update and modify your profile information as needed.</li>
</ul>
<p><img loading="lazy" src="/projects/SciaTech/product1.jpg" alt=""  />

<img loading="lazy" src="/projects/SciaTech/product2.jpg" alt=""  />
</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://abirarsalane.github.io/tags/ai/">AI</a></li>
      <li><a href="https://abirarsalane.github.io/tags/iot/">IOT</a></li>
      <li><a href="https://abirarsalane.github.io/tags/aws/">AWS</a></li>
      <li><a href="https://abirarsalane.github.io/tags/ey/">EY</a></li>
      <li><a href="https://abirarsalane.github.io/tags/innovation/">Innovation</a></li>
      <li><a href="https://abirarsalane.github.io/tags/python/">Python</a></li>
      <li><a href="https://abirarsalane.github.io/tags/challenge/">Challenge</a></li>
      <li><a href="https://abirarsalane.github.io/tags/ml/">ML</a></li>
      <li><a href="https://abirarsalane.github.io/tags/dl/">DL</a></li>
      <li><a href="https://abirarsalane.github.io/tags/recommendations-system/">Recommendations System</a></li>
      <li><a href="https://abirarsalane.github.io/tags/models/">Models</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="https://abirarsalane.github.io/">Abir Arsalane</a></span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
